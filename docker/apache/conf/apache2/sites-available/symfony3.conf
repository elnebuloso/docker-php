<VirtualHost *:80>

        DocumentRoot /var/www/web

        <Directory /var/www/web>
                RewriteEngine On
                RewriteBase /

                # The following rule tells Apache that if the requested filename
                # exists, simply serve it.
                RewriteCond %{REQUEST_FILENAME} -s [OR]
                RewriteCond %{REQUEST_FILENAME} -l [OR]
                RewriteCond %{REQUEST_FILENAME} -d
                RewriteRule ^.*$ - [NC,L]

                # The following rewrites all other queries to the index. The
                # condition ensures that if you are using Apache aliases to do
                # mass virtual hosting, the base path will be prepended to
                # allow proper resolution of the index.php file; it will work
                # in non-aliased environments as well, providing a safe, one-size
                # fits all solution.
                RewriteCond %{REQUEST_URI}::$1 ^(/.+)(.+)::\2$
                RewriteRule ^(.*) - [E=BASE:%1]

                RewriteCond %{ENV:APP_ENV} "^prod$"
                RewriteRule ^(.*)$ %{ENV:BASE}app.php [NC,L]

                RewriteRule ^(.*)$ %{ENV:BASE}app_dev.php [NC,L]

                Require all granted
                Options FollowSymLinks
                AllowOverride All
        </Directory>

        # optionally disable the RewriteEngine for the asset directories
        # which will allow apache to simply reply with a 404 when files are
        # not found instead of passing the request into the full symfony stack
        <Directory /var/www/web/bundles>
                RewriteEngine Off
        </Directory>

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel info

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        php_flag log_errors on
        php_flag ignore_repeated_errors off
        php_flag ignore_repeated_source off
        php_flag report_memleaks on
        php_flag track_errors on
        php_value docref_root 0
        php_value docref_ext 0
        php_value log_errors_max_len 0

        <If "'${APP_ENV}' == 'prod'">
            php_flag display_startup_errors off
            php_flag display_errors off
            php_flag html_errors off
        </If>
        <Else>
            php_flag display_startup_errors on
            php_flag display_errors on
            php_flag html_errors on

            Header set X-Robots-Tag "noindex, nofollow, noarchive"
        </Else>

        <If "'${APP_ENV}' == 'prod'">
            DirectoryIndex app.php index.html
        </If>
        <Else>
            DirectoryIndex app_dev.php index.html
        </Else>

</VirtualHost>